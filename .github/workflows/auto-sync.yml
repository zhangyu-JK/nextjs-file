name: Push 后自动同步到镜像仓库

permissions:
  contents: read

on:
  push:
    branches:
      - "**"

jobs:
  sync:
    runs-on: ubuntu-latest
    if: ${{ vars.SYNC_TARGET_REPO != '' }}
    steps:
      - uses: actions/checkout@v4
        with:
          persist-credentials: false

      - name: 同步当前分支到镜像仓库
        uses: repo-sync/github-sync@v2
        with:
          source_repo: ${{ github.repository }}
          source_branch: ${{ github.ref_name }}
          destination_repo: ${{ vars.SYNC_TARGET_REPO }} # 例如 owner/mirror-repo
          destination_branch: ${{ github.ref_name }}
          sync_tags: "false"
          github_token: ${{ secrets.GH_SYNC_TOKEN }}

